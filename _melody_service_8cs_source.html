<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SipClass5: Settings/Melodies/Service/MelodyService.cs Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SipClass5
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_melody_service_8cs_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">MelodyService.cs</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_melody_service_8cs.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">using</span> System;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">using</span> System.Collections.Generic;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="keyword">using</span> System.Linq;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">using</span> System.Threading.Tasks;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_cordis.html">Cordis</a>.<a class="code" href="namespace_cordis_1_1_core.html">Core</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip.html">Sip</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5.html">Class5</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_extension.html">Extension</a>;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_cordis.html">Cordis</a>.<a class="code" href="namespace_cordis_1_1_core.html">Core</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip.html">Sip</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5.html">Class5</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings.html">Settings</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model.html">DataModel</a>;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_cordis.html">Cordis</a>.<a class="code" href="namespace_cordis_1_1_core.html">Core</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip.html">Sip</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5.html">Class5</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings.html">Settings</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_exceptions.html">Exceptions</a>;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_cordis.html">Cordis</a>.<a class="code" href="namespace_cordis_1_1_core.html">Core</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip.html">Sip</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5.html">Class5</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings.html">Settings</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_interface.html">Interface</a>;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_cordis.html">Cordis</a>.<a class="code" href="namespace_cordis_1_1_core.html">Core</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip.html">Sip</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5.html">Class5</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings.html">Settings</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies.html">Melodies</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository.html">Repository</a>;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_cordis.html">Cordis</a>.<a class="code" href="namespace_cordis_1_1_core.html">Core</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip.html">Sip</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5.html">Class5</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings.html">Settings</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_repository.html">Repository</a>;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_cordis.html">Cordis</a>.<a class="code" href="namespace_cordis_1_1_core.html">Core</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip.html">Sip</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5.html">Class5</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings.html">Settings</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands.html">RtuCommands</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_repository.html">Repository</a>;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_cordis.html">Cordis</a>.<a class="code" href="namespace_cordis_1_1_core.html">Core</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip.html">Sip</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5.html">Class5</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings.html">Settings</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands.html">RtuCommands</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_service.html">Service</a>;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_cordis.html">Cordis</a>.<a class="code" href="namespace_cordis_1_1_core.html">Core</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip.html">Sip</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5.html">Class5</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings.html">Settings</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vte_routing.html">VteRouting</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vte_routing_1_1_service.html">Service</a>;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_cordis.html">Cordis</a>.<a class="code" href="namespace_cordis_1_1_core.html">Core</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip.html">Sip</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5.html">Class5</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings.html">Settings</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes.html">Vtes</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_1_1_repository.html">Repository</a>;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_cordis.html">Cordis</a>.<a class="code" href="namespace_cordis_1_1_core.html">Core</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip.html">Sip</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5.html">Class5</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings.html">Settings</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes.html">Vtes</a>.<a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_1_1_service.html">Service</a>;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service.html">Cordis.Core.Sip.Class5.Settings.Melodies.Service</a></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html">   22</a></span>&#160;    <span class="keyword">internal</span> <span class="keyword">class </span><a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html">MelodyService</a> : <a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_interface_1_1_i_melody_service.html">IMelodyService</a></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">        #region Constants</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a23335d1a519b826e828d50f4846d2934">   29</a></span>&#160;        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keywordtype">string</span> <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a23335d1a519b826e828d50f4846d2934">MUSIC_ON_HOLD</a> = <span class="stringliteral">&quot;Music on hold&quot;</span>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#ae15893d2715ff08dbc3b314555c3a98f">   34</a></span>&#160;        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keywordtype">string</span> <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#ae15893d2715ff08dbc3b314555c3a98f">RINGBACK</a> = <span class="stringliteral">&quot;Ringback&quot;</span>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a074d131010e1da12f69dae0b7f90412f">   39</a></span>&#160;        <span class="keyword">private</span> readonly <span class="keywordtype">string</span>[] <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a074d131010e1da12f69dae0b7f90412f">PUBLIC_SYSTEM_MELODIES</a> = { <span class="stringliteral">&quot;Music on hold&quot;</span> };</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">        #endregion</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">        #region Fields</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4ddd37933c631e5c9f4f58dc90c629e2">   48</a></span>&#160;        <span class="keyword">private</span> readonly <a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html">IMelodyRepository</a> <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4ddd37933c631e5c9f4f58dc90c629e2">_melodyRepository</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a593a7bd06d64e8e28b75428ea3a81510">   53</a></span>&#160;        <span class="keyword">private</span> readonly <a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_interface_1_1_i_vte_service.html">IVteService</a> <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a593a7bd06d64e8e28b75428ea3a81510">_vteService</a>; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a5a9f7ea4455879dd1632f5dab877db83">   58</a></span>&#160;        <span class="keyword">private</span> readonly <a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_1_1_repository_1_1_i_vte_repository.html">IVteRepository</a> <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a5a9f7ea4455879dd1632f5dab877db83">_vteRepository</a>; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a9381b83fc904cbe5c628fd7202673ec9">   63</a></span>&#160;        <span class="keyword">private</span> readonly <a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_i_melody_validation_service.html">IMelodyValidationService</a> <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a9381b83fc904cbe5c628fd7202673ec9">_melodyValidationService</a>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a7bb39314ae42ea36c16c91ff86151e99">   68</a></span>&#160;        <span class="keyword">private</span> readonly <a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_1_1_service_1_1_i_vte_validation_service.html">IVteValidationService</a> <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a7bb39314ae42ea36c16c91ff86151e99">_vteValidationService</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a5a799b2172f3f20d202d185658c80066">   73</a></span>&#160;        <span class="keyword">private</span> readonly <a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_repository_1_1_i_rtu_repository.html">IRtuRepository</a> <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a5a799b2172f3f20d202d185658c80066">_rtuRepository</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#abfe2d45197ab60a26a0df940a1645e28">   78</a></span>&#160;        <span class="keyword">private</span> readonly <a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_service_1_1_i_rtu_query_service.html">IRtuQueryService</a> <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#abfe2d45197ab60a26a0df940a1645e28">_rtuQueryService</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a71e08e3aa56b0c6573aa1943d84dc7d3">   83</a></span>&#160;        <span class="keyword">private</span> readonly <a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vte_routing_1_1_service_1_1_i_ivr_service.html">IIvrService</a> <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a71e08e3aa56b0c6573aa1943d84dc7d3">_ivrService</a>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a99bb0aa2d10ce4d642d55ad2b58d8a7c">   88</a></span>&#160;        <span class="keyword">private</span> readonly <a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_repository_1_1_i_base_repository.html">IBaseRepository</a> <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a99bb0aa2d10ce4d642d55ad2b58d8a7c">_baseRepository</a>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">        #endregion</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#adcaf6f9449e6a01f7a23cc085f375258">   95</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#adcaf6f9449e6a01f7a23cc085f375258">MelodyService</a>(</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html">IMelodyRepository</a> melodyRepository,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_interface_1_1_i_vte_service.html">IVteService</a> vteService,</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_1_1_repository_1_1_i_vte_repository.html">IVteRepository</a> vteRepository,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_i_melody_validation_service.html">IMelodyValidationService</a> melodyValidationService,</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_1_1_service_1_1_i_vte_validation_service.html">IVteValidationService</a> vteValidationService,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_repository_1_1_i_rtu_repository.html">IRtuRepository</a> rtuRepository,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            <a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_service_1_1_i_rtu_query_service.html">IRtuQueryService</a> rtuQueryService,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vte_routing_1_1_service_1_1_i_ivr_service.html">IIvrService</a> ivrService,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            <a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_repository_1_1_i_base_repository.html">IBaseRepository</a> baseRepository</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            )</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4ddd37933c631e5c9f4f58dc90c629e2">_melodyRepository</a> = melodyRepository;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a593a7bd06d64e8e28b75428ea3a81510">_vteService</a> = vteService;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a5a9f7ea4455879dd1632f5dab877db83">_vteRepository</a> = vteRepository;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a9381b83fc904cbe5c628fd7202673ec9">_melodyValidationService</a> = melodyValidationService;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a5a799b2172f3f20d202d185658c80066">_rtuRepository</a> = rtuRepository;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#abfe2d45197ab60a26a0df940a1645e28">_rtuQueryService</a> = rtuQueryService;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a71e08e3aa56b0c6573aa1943d84dc7d3">_ivrService</a> = ivrService;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a7bb39314ae42ea36c16c91ff86151e99">_vteValidationService</a> = vteValidationService;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a99bb0aa2d10ce4d642d55ad2b58d8a7c">_baseRepository</a> = baseRepository;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">        #region Async</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#aa006e577bc8d949849a88b487e8ed716">  125</a></span>&#160;        <span class="keyword">public</span> async Task&lt;IEnumerable&lt;MelodyInfo&gt;&gt; <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#aa006e577bc8d949849a88b487e8ed716">GetByVteAsync</a>(<span class="keywordtype">int</span> vteId)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="keywordflow">if</span> (!(await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a593a7bd06d64e8e28b75428ea3a81510">_vteService</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_interface_1_1_i_vte_service.html#a8c0aeb58e65398330d6196c0928b23b9">GetVtesAsync</a>(<span class="keyword">new</span> [] { vteId })).Any())</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                <span class="keywordflow">return</span> Enumerable.Empty&lt;<a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1_melody_info.html">MelodyInfo</a>&gt;();</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            var melodies = (await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4ddd37933c631e5c9f4f58dc90c629e2">_melodyRepository</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html#ae1dec0c9a6734938c7a621deb07aae2c">GetMelodiesByVteIdAsync</a>(vteId)).ToList();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            var result = <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a2d0508f30f61c233ea1c8bcdf2238498">ExtractPublicMelodies</a>(melodies);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a179b8d389e1b395c2184c94f7245f251">  148</a></span>&#160;        <span class="keyword">public</span> async Task&lt;int&gt; <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a179b8d389e1b395c2184c94f7245f251">UploadAsync</a>(<span class="keywordtype">int</span> vteId, <span class="keywordtype">string</span> name, <span class="keywordtype">string</span> fileExtension, <span class="keywordtype">byte</span>[] bytes)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a9381b83fc904cbe5c628fd7202673ec9">_melodyValidationService</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_i_melody_validation_service.html#a72e8482076bea4ab3791087abb69ae91">ValidateFileExtension</a>(fileExtension);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a7bb39314ae42ea36c16c91ff86151e99">_vteValidationService</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_1_1_service_1_1_i_vte_validation_service.html#acc9d729d00509854fb9272a010f7e284">ValidateDomainIdAsync</a>(vteId);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            var counter = 0;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="comment">// В структурах РТУ в качестве Descritpion используем имя файла.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            var validDescritpion = name;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            var existingMelodies = ((await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#aa006e577bc8d949849a88b487e8ed716">GetByVteAsync</a>(vteId)) as IEnumerable&lt;MelodyInfoWithRtuName&gt;).ToList();</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <span class="keywordflow">while</span> (existingMelodies.Any(p =&gt; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <span class="keywordtype">string</span>.Equals(p.Name, validDescritpion, StringComparison.OrdinalIgnoreCase)))</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                counter++;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                validDescritpion = $<span class="stringliteral">&quot;{name} ({counter})&quot;</span>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="comment">// Для идентфикации мелодии (rtu.prompt.name) сгенерируем гуид.</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            var validName = Guid.NewGuid().ToString();</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a9381b83fc904cbe5c628fd7202673ec9">_melodyValidationService</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_i_melody_validation_service.html#ab83b67df22c93f41f519d4d162d6acda">ValidateFileDescriptionAsync</a>(vteId, validDescritpion);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            var duration = <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a1d1ae91efb4ef1a3da02d6f1f3a595c3">GetDuration</a>($<span class="stringliteral">&quot;{name}.{fileExtension}&quot;</span>, bytes);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">if</span> (duration.TotalSeconds &gt; 300)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_exceptions_1_1_invalid_file_duration_exception.html">InvalidFileDurationException</a>();</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            var melodyCategoryId = await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4ddd37933c631e5c9f4f58dc90c629e2">_melodyRepository</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html#ada345c41a263f0e84908ecf853c67826">GetMelodyCategoryIdByVteIdAsync</a>(vteId) ?? await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4ddd37933c631e5c9f4f58dc90c629e2">_melodyRepository</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html#a7616a9b96785b9ef9036ac1776cba965">AddMelodyCategoryAsync</a>(vteId);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            var createdMelodyId = await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4ddd37933c631e5c9f4f58dc90c629e2">_melodyRepository</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html#af1f058b960740f0015b560f1d8ebfaac">AddMelodyAsync</a>(validName, validDescritpion, vteId, melodyCategoryId, bytes, duration, fileExtension);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a5a9f7ea4455879dd1632f5dab877db83">_vteRepository</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_1_1_repository_1_1_i_vte_repository.html#adfce78f9b94b9b266c833f1e843e7830">ConfigureAsync</a>(vteId);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="keywordflow">return</span> createdMelodyId;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#ace6b34ce0afcb7d38438a0ffef037954">  190</a></span>&#160;        <span class="keyword">public</span> async Task <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#ace6b34ce0afcb7d38438a0ffef037954">RenameAsync</a>(<span class="keywordtype">int</span> melodyId, <span class="keywordtype">string</span> newName)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a9381b83fc904cbe5c628fd7202673ec9">_melodyValidationService</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_i_melody_validation_service.html#a18a378bb4f66f2b9ede87a1673b9f549">ValidateMelodyIdAsync</a>(melodyId);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            var melody = await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4ddd37933c631e5c9f4f58dc90c629e2">_melodyRepository</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html#a004b7ec1f6453ff20b399a6d69a4fa3e">GetMelodyByIdAsync</a>(melodyId);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="comment">// В структурах РТУ имя файла храним в описании rtu.prompt.description, поэтому валидация идет по полю description.</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a9381b83fc904cbe5c628fd7202673ec9">_melodyValidationService</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_i_melody_validation_service.html#ab83b67df22c93f41f519d4d162d6acda">ValidateFileDescriptionAsync</a>(melody.VteId, newName, melodyId);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4ddd37933c631e5c9f4f58dc90c629e2">_melodyRepository</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html#a1e81397412684d86d8274acba9795d41">UpdateMelodyDescriptionAsync</a>(melody.VteId, melody.Name, newName);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a9b128a1155b3d04ed6ec4cc76826092a">  207</a></span>&#160;        <span class="keyword">public</span> async Task <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a9b128a1155b3d04ed6ec4cc76826092a">DeleteAsync</a>(<span class="keywordtype">int</span> melodyId)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            var melodyInIvr = await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4fcf7e92de8fb1c2a537cc1342972f68">GetMelodyInIvrsAsync</a>(melodyId);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a9381b83fc904cbe5c628fd7202673ec9">_melodyValidationService</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_i_melody_validation_service.html#aa792db1077db817734742d10f15d50e9">ValidateMelodyIdForDeletionAsync</a>(melodyId, melodyInIvr.Any());</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            var melody = await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4ddd37933c631e5c9f4f58dc90c629e2">_melodyRepository</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html#a004b7ec1f6453ff20b399a6d69a4fa3e">GetMelodyByIdAsync</a>(melodyId);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            var vteMelodies = await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4ddd37933c631e5c9f4f58dc90c629e2">_melodyRepository</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html#ae1dec0c9a6734938c7a621deb07aae2c">GetMelodiesByVteIdAsync</a>(melody.VteId);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <span class="comment">// Важно удалять все мелодии по имени, так как при установки мелодии удержание происходит дублирование записи в таблице.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4ddd37933c631e5c9f4f58dc90c629e2">_melodyRepository</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html#a1df9e8cc195c51f551a28294a37388d1">DeleteMelodiesAsync</a>(vteMelodies.Where(m =&gt; m.Name == melody.Name).Select(m =&gt; m.Id));</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a5a9f7ea4455879dd1632f5dab877db83">_vteRepository</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_1_1_repository_1_1_i_vte_repository.html#adfce78f9b94b9b266c833f1e843e7830">ConfigureAsync</a>(melody.VteId);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4287d8d1dbf88f6c791d17bcb51d72b3">  226</a></span>&#160;        <span class="keyword">public</span> async Task&lt;byte[]&gt; <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4287d8d1dbf88f6c791d17bcb51d72b3">DownloadAsync</a>(<span class="keywordtype">int</span> fileId)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a9381b83fc904cbe5c628fd7202673ec9">_melodyValidationService</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_i_melody_validation_service.html#a18a378bb4f66f2b9ede87a1673b9f549">ValidateMelodyIdAsync</a>(fileId);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            var bytes = await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4ddd37933c631e5c9f4f58dc90c629e2">_melodyRepository</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html#a00fe07f2f090ddcb4352b7deb6642cd7">GetMelodyBytesByIdAsync</a>(fileId);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <span class="keywordflow">if</span> (bytes != <span class="keyword">null</span>)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                <span class="keywordflow">return</span> bytes;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            var (name, category, rtuDomainId) = await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4ddd37933c631e5c9f4f58dc90c629e2">_melodyRepository</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html#a9bd2662af5d6f14bf404b909f82e57ef">GetMelodyAndCategoryNameAndRtuDomainIdByMelodyIdAsync</a>(fileId);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            var fileUrl = (await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#abfe2d45197ab60a26a0df940a1645e28">_rtuQueryService</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_service_1_1_i_rtu_query_service.html#adf99f43994567bf5630aa480eb00d8b6">GetPromptsByNameAndCategoryAsync</a>(rtuDomainId, name, category))</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                .Single().FileUrl;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            var melodyFile = await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a5a799b2172f3f20d202d185658c80066">_rtuRepository</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_repository_1_1_i_rtu_repository.html#a2d8da79311eeda796770a5319e6f0b85">DownloadFileAsync</a>(fileUrl.AppendHttpPrefix());</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="keywordflow">if</span>(melodyFile.Length == 0)</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                fileUrl = (await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#abfe2d45197ab60a26a0df940a1645e28">_rtuQueryService</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_service_1_1_i_rtu_query_service.html#adf99f43994567bf5630aa480eb00d8b6">GetPromptsByNameAndCategoryAsync</a>(rtuDomainId, name, category))</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                .Single().FileUrl;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                melodyFile = await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a5a799b2172f3f20d202d185658c80066">_rtuRepository</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_repository_1_1_i_rtu_repository.html#a2d8da79311eeda796770a5319e6f0b85">DownloadFileAsync</a>(fileUrl.AppendHttpPrefix());</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <span class="keywordflow">if</span> (melodyFile.Length == 0)</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_exceptions_1_1_melody_not_found_exception.html">MelodyNotFoundException</a>();</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="keywordflow">return</span> melodyFile;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4fcf7e92de8fb1c2a537cc1342972f68">  259</a></span>&#160;        <span class="keyword">public</span> async Task&lt;IEnumerable&lt;MelodyInIvr&gt;&gt; <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4fcf7e92de8fb1c2a537cc1342972f68">GetMelodyInIvrsAsync</a>(<span class="keywordtype">int</span> melodyId)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            var result = <span class="keyword">new</span> List&lt;MelodyInIvr&gt;();</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            var domain = (await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a99bb0aa2d10ce4d642d55ad2b58d8a7c">_baseRepository</a>.GetByAsync&lt;<a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1rtu.html">rtu</a>.<a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1rtu_1_1prompt.html">prompt</a>&gt;(<span class="keyword">new</span> { prompt = melodyId, user = (<span class="keywordtype">int</span>?)<span class="keyword">null</span> }, <span class="keyword">new</span> { domain = (int)0 }.GetType())).ToList();</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="keywordflow">if</span> (!domain.Any())</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <span class="keywordtype">int</span> domainId = domain.First().domain;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keywordflow">foreach</span> (var ivrScript <span class="keywordflow">in</span> await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a99bb0aa2d10ce4d642d55ad2b58d8a7c">_baseRepository</a>.GetByAsync&lt;<a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1rtu.html">rtu</a>.<a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1rtu_1_1ivr__script.html">ivr_script</a>&gt;(<span class="keyword">new</span> { domain = domainId }, <span class="keyword">new</span> { name = (string)<span class="keyword">null</span>, script = (<span class="keywordtype">string</span>)<span class="keyword">null</span> }.GetType()))</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                var ivr = await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a71e08e3aa56b0c6573aa1943d84dc7d3">_ivrService</a>.<a class="code" href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vte_routing_1_1_service_1_1_i_ivr_service.html#a69cca435908745e1fa82d376e9686a53">DeserializeScriptAsync</a>((<span class="keywordtype">string</span>)ivrScript.script, domainId);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                <span class="keywordflow">if</span> (ivr.MelodyId != melodyId)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                var followMeId = <span class="keywordtype">int</span>.Parse(((<span class="keywordtype">string</span>) ivrScript.name).Replace(<span class="stringliteral">&quot;ivr_script_by_Route&quot;</span>, <span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                var userId = (int) (await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a99bb0aa2d10ce4d642d55ad2b58d8a7c">_baseRepository</a>.GetByAsync&lt;<a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1rtu.html">rtu</a>.<a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1rtu_1_1follow__me.html">follow_me</a>&gt;(<span class="keyword">new</span> {follow_me = followMeId}, <span class="keyword">new</span> {user = (int) 0}.GetType())).First().user;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                result.Add(<span class="keyword">new</span> <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1_melody_in_ivr.html">MelodyInIvr</a></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                    MelodyId = melodyId,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                    IvrName = ivr.Name,</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                    ExternalNumberId = (int)(await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a99bb0aa2d10ce4d642d55ad2b58d8a7c">_baseRepository</a>.GetByAsync&lt;DataModel.Voice.phone_number&gt;(<span class="keyword">new</span> { rtu_user = userId }, <span class="keyword">new</span> { phone_number = (int)0 }.GetType())).First().phone_number,</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                    RouteId = (int)(await <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a99bb0aa2d10ce4d642d55ad2b58d8a7c">_baseRepository</a>.GetByAsync&lt;<a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1rtu.html">rtu</a>.<a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1rtu_1_1additional__forwarding.html">additional_forwarding</a>&gt;(<span class="keyword">new</span> { follow_me = followMeId, user = userId }, <span class="keyword">new</span> { additional_forwarding = (int)0 }.GetType())).First().additional_forwarding</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                });</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="preprocessor">        #endregion</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="preprocessor">        #region Methods/Private</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a1d1ae91efb4ef1a3da02d6f1f3a595c3">  300</a></span>&#160;        <span class="keyword">private</span> TimeSpan <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a1d1ae91efb4ef1a3da02d6f1f3a595c3">GetDuration</a>(<span class="keywordtype">string</span> filename, <span class="keywordtype">byte</span>[] bytes)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordflow">try</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                var tfile = TagLib.File.Create(<span class="keyword">new</span> <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1_file_bytes_abstraction.html">FileBytesAbstraction</a>(filename, bytes));</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                <span class="keywordflow">return</span> tfile.Properties.Duration;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <span class="keywordflow">catch</span> (TagLib.CorruptFileException) </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_exceptions_1_1_invalid_file_format_exception.html">InvalidFileFormatException</a>();</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a2d0508f30f61c233ea1c8bcdf2238498">  319</a></span>&#160;        <span class="keyword">private</span> IEnumerable&lt;MelodyInfo&gt; <a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a2d0508f30f61c233ea1c8bcdf2238498">ExtractPublicMelodies</a>(List&lt;MelodyInfoWithRtuName&gt; melodies)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            var notDefaultVteMelodies = melodies.Where(m =&gt; !m.IsDefault &amp;&amp; m.PortId == <span class="keyword">null</span>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            var defaultVteMelodies = melodies.Where(m =&gt; m.IsDefault</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                &amp;&amp; m.PortId == <span class="keyword">null</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                &amp;&amp; PUBLIC_SYSTEM_MELODIES.Contains(m.RtuName));</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="comment">//Возможно, нам этот блок не нужен. Потому что мы можем отображать любую мелодию домена. А ограничение списка выполнено переменной PUBLIC_SYSTEM_MELODIES</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            var vtePorts2DefaultMelodies = melodies.Where(m =&gt; m.IsDefault &amp;&amp; m.PortId != <span class="keyword">null</span>).GroupBy(m =&gt; m.PortId).ToList();</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            var defaultMelodiesExistingInEveryPort = vtePorts2DefaultMelodies.Any() ?</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                defaultVteMelodies.Where(m =&gt; vtePorts2DefaultMelodies.All(p =&gt; p.Any(pm =&gt; pm.RtuName == m.RtuName))) :</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                Enumerable.Empty&lt;<a class="code" href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1_melody_info_with_rtu_name.html">MelodyInfoWithRtuName</a>&gt;();</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="keywordflow">return</span> notDefaultVteMelodies.Union(defaultMelodiesExistingInEveryPort);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="preprocessor">        #endregion</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;}</div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1_file_bytes_abstraction_html"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1_file_bytes_abstraction.html">Cordis.Core.Sip.Class5.Settings.DataModel.FileBytesAbstraction</a></div><div class="ttdoc">Класс обертка для преобразования набора байтов в FileBytesAbstraction для TagLib.</div><div class="ttdef"><b>Definition:</b> <a href="_file_bytes_abstraction_8cs_source.html#l00008">FileBytesAbstraction.cs:9</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1_melody_in_ivr_html"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1_melody_in_ivr.html">Cordis.Core.Sip.Class5.Settings.DataModel.MelodyInIvr</a></div><div class="ttdoc">Информация об использовании мелодии в голосовом меню.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_in_ivr_8cs_source.html#l00010">MelodyInIvr.cs:11</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1_melody_info_html"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1_melody_info.html">Cordis.Core.Sip.Class5.Settings.DataModel.MelodyInfo</a></div><div class="ttdoc">Информация о мелодии.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_info_8cs_source.html#l00006">MelodyInfo.cs:7</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1_melody_info_with_rtu_name_html"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1_melody_info_with_rtu_name.html">Cordis.Core.Sip.Class5.Settings.DataModel.MelodyInfoWithRtuName</a></div><div class="ttdoc">Информация о мелодии с внутренним именем РТУ.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_info_with_rtu_name_8cs_source.html#l00006">MelodyInfoWithRtuName.cs:7</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1rtu_1_1additional__forwarding_html"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1rtu_1_1additional__forwarding.html">Cordis.Core.Sip.Class5.Settings.DataModel.rtu.additional_forwarding</a></div><div class="ttdoc">Дополнительные настройки переадресации.</div><div class="ttdef"><b>Definition:</b> <a href="rtu_8cs_source.html#l00011">rtu.cs:11</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1rtu_1_1follow__me_html"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1rtu_1_1follow__me.html">Cordis.Core.Sip.Class5.Settings.DataModel.rtu.follow_me</a></div><div class="ttdoc">Параметры сценария &quot;Следуй за мной&quot;.</div><div class="ttdef"><b>Definition:</b> <a href="rtu_8cs_source.html#l00036">rtu.cs:36</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1rtu_1_1ivr__script_html"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1rtu_1_1ivr__script.html">Cordis.Core.Sip.Class5.Settings.DataModel.rtu.ivr_script</a></div><div class="ttdoc">Сценарии IVR.</div><div class="ttdef"><b>Definition:</b> <a href="rtu_8cs_source.html#l00081">rtu.cs:81</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1rtu_1_1prompt_html"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1rtu_1_1prompt.html">Cordis.Core.Sip.Class5.Settings.DataModel.rtu.prompt</a></div><div class="ttdoc">Аудио-файлы.</div><div class="ttdef"><b>Definition:</b> <a href="rtu_8cs_source.html#l00091">rtu.cs:91</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1rtu_html"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_1_1rtu.html">Cordis.Core.Sip.Class5.Settings.DataModel.rtu</a></div><div class="ttdoc">Объекты РТУ МОА.</div><div class="ttdef"><b>Definition:</b> <a href="rtu_8cs_source.html#l00006">rtu.cs:7</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_exceptions_1_1_invalid_file_duration_exception_html"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_exceptions_1_1_invalid_file_duration_exception.html">Cordis.Core.Sip.Class5.Settings.Exceptions.InvalidFileDurationException</a></div><div class="ttdef"><b>Definition:</b> <a href="_invalid_file_duration_exception_8cs_source.html#l00007">InvalidFileDurationException.cs:8</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_exceptions_1_1_invalid_file_format_exception_html"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_exceptions_1_1_invalid_file_format_exception.html">Cordis.Core.Sip.Class5.Settings.Exceptions.InvalidFileFormatException</a></div><div class="ttdoc">Исключение &quot;неверный формат файла&quot;.</div><div class="ttdef"><b>Definition:</b> <a href="_invalid_file_format_exception_8cs_source.html#l00006">InvalidFileFormatException.cs:7</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_exceptions_1_1_melody_not_found_exception_html"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_exceptions_1_1_melody_not_found_exception.html">Cordis.Core.Sip.Class5.Settings.Exceptions.MelodyNotFoundException</a></div><div class="ttdoc">Исключение &quot;Мелодия не найдена&quot;.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_not_found_exception_8cs_source.html#l00006">MelodyNotFoundException.cs:7</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService</a></div><div class="ttdoc">Сервис управления телефонными мелодиями.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00022">MelodyService.cs:23</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html_a074d131010e1da12f69dae0b7f90412f"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a074d131010e1da12f69dae0b7f90412f">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService.PUBLIC_SYSTEM_MELODIES</a></div><div class="ttdeci">readonly string[] PUBLIC_SYSTEM_MELODIES</div><div class="ttdoc">Имена(регистрочувствительны) системных мелодий домена, которые доступны для показа в ЛК.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00039">MelodyService.cs:39</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html_a179b8d389e1b395c2184c94f7245f251"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a179b8d389e1b395c2184c94f7245f251">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService.UploadAsync</a></div><div class="ttdeci">async Task&lt; int &gt; UploadAsync(int vteId, string name, string fileExtension, byte[] bytes)</div><div class="ttdoc">Сохраняет информацию о загруженном файле.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00148">MelodyService.cs:148</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html_a1d1ae91efb4ef1a3da02d6f1f3a595c3"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a1d1ae91efb4ef1a3da02d6f1f3a595c3">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService.GetDuration</a></div><div class="ttdeci">TimeSpan GetDuration(string filename, byte[] bytes)</div><div class="ttdoc">Возвращает длительность файла.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00300">MelodyService.cs:300</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html_a23335d1a519b826e828d50f4846d2934"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a23335d1a519b826e828d50f4846d2934">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService.MUSIC_ON_HOLD</a></div><div class="ttdeci">const string MUSIC_ON_HOLD</div><div class="ttdoc">Название мелодии, стоящей на удержании.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00029">MelodyService.cs:29</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html_a2d0508f30f61c233ea1c8bcdf2238498"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a2d0508f30f61c233ea1c8bcdf2238498">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService.ExtractPublicMelodies</a></div><div class="ttdeci">IEnumerable&lt; MelodyInfo &gt; ExtractPublicMelodies(List&lt; MelodyInfoWithRtuName &gt; melodies)</div><div class="ttdoc">Выполняет фильтрацию мелодий. Возвращает только загруженные пользователем мелодии,...</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00319">MelodyService.cs:319</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html_a4287d8d1dbf88f6c791d17bcb51d72b3"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4287d8d1dbf88f6c791d17bcb51d72b3">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService.DownloadAsync</a></div><div class="ttdeci">async Task&lt; byte[]&gt; DownloadAsync(int fileId)</div><div class="ttdoc">Возвращает байты файла с указанным идентификатором.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00226">MelodyService.cs:226</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html_a4ddd37933c631e5c9f4f58dc90c629e2"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4ddd37933c631e5c9f4f58dc90c629e2">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService._melodyRepository</a></div><div class="ttdeci">readonly IMelodyRepository _melodyRepository</div><div class="ttdoc">Репозиторий для управления телефонными мелодиями.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00048">MelodyService.cs:48</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html_a4fcf7e92de8fb1c2a537cc1342972f68"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a4fcf7e92de8fb1c2a537cc1342972f68">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService.GetMelodyInIvrsAsync</a></div><div class="ttdeci">async Task&lt; IEnumerable&lt; MelodyInIvr &gt; &gt; GetMelodyInIvrsAsync(int melodyId)</div><div class="ttdoc">Возвращает информацию об использовании мелодии в голосовом меню.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00259">MelodyService.cs:259</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html_a593a7bd06d64e8e28b75428ea3a81510"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a593a7bd06d64e8e28b75428ea3a81510">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService._vteService</a></div><div class="ttdeci">readonly IVteService _vteService</div><div class="ttdoc">Сервис методов управления параметрами ВАТС.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00053">MelodyService.cs:53</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html_a5a799b2172f3f20d202d185658c80066"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a5a799b2172f3f20d202d185658c80066">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService._rtuRepository</a></div><div class="ttdeci">readonly IRtuRepository _rtuRepository</div><div class="ttdoc">Репозиторий для работы с запросами РТУ.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00073">MelodyService.cs:73</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html_a5a9f7ea4455879dd1632f5dab877db83"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a5a9f7ea4455879dd1632f5dab877db83">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService._vteRepository</a></div><div class="ttdeci">readonly IVteRepository _vteRepository</div><div class="ttdoc">Сервис методов управления параметрами ВАТС.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00058">MelodyService.cs:58</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html_a71e08e3aa56b0c6573aa1943d84dc7d3"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a71e08e3aa56b0c6573aa1943d84dc7d3">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService._ivrService</a></div><div class="ttdeci">readonly IIvrService _ivrService</div><div class="ttdoc">Сервис для работы с голосовым меню.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00083">MelodyService.cs:83</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html_a7bb39314ae42ea36c16c91ff86151e99"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a7bb39314ae42ea36c16c91ff86151e99">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService._vteValidationService</a></div><div class="ttdeci">readonly IVteValidationService _vteValidationService</div><div class="ttdoc">Сервис проверок при выполнении методов управления параметрами ВАТС.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00068">MelodyService.cs:68</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html_a9381b83fc904cbe5c628fd7202673ec9"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a9381b83fc904cbe5c628fd7202673ec9">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService._melodyValidationService</a></div><div class="ttdeci">readonly IMelodyValidationService _melodyValidationService</div><div class="ttdoc">Сервис проверок при выполнении методов управления телефонными мелодиями.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00063">MelodyService.cs:63</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html_a99bb0aa2d10ce4d642d55ad2b58d8a7c"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a99bb0aa2d10ce4d642d55ad2b58d8a7c">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService._baseRepository</a></div><div class="ttdeci">readonly IBaseRepository _baseRepository</div><div class="ttdoc">Базовый репозиторий для работы с таблицей в БД.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00088">MelodyService.cs:88</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html_a9b128a1155b3d04ed6ec4cc76826092a"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#a9b128a1155b3d04ed6ec4cc76826092a">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService.DeleteAsync</a></div><div class="ttdeci">async Task DeleteAsync(int melodyId)</div><div class="ttdoc">Удаляет мелодию.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00207">MelodyService.cs:207</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html_aa006e577bc8d949849a88b487e8ed716"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#aa006e577bc8d949849a88b487e8ed716">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService.GetByVteAsync</a></div><div class="ttdeci">async Task&lt; IEnumerable&lt; MelodyInfo &gt; &gt; GetByVteAsync(int vteId)</div><div class="ttdoc">Возвращает список аудио-файлов, доступных в ВАТС с указанным идентификатором.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00125">MelodyService.cs:125</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html_abfe2d45197ab60a26a0df940a1645e28"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#abfe2d45197ab60a26a0df940a1645e28">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService._rtuQueryService</a></div><div class="ttdeci">readonly IRtuQueryService _rtuQueryService</div><div class="ttdoc">Сервис для работы с запросами к РТУ.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00078">MelodyService.cs:78</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html_ace6b34ce0afcb7d38438a0ffef037954"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#ace6b34ce0afcb7d38438a0ffef037954">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService.RenameAsync</a></div><div class="ttdeci">async Task RenameAsync(int melodyId, string newName)</div><div class="ttdoc">Устанавливает параметр RTU.prompt.description = newName для записи с указанным идентификатором.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00190">MelodyService.cs:190</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html_adcaf6f9449e6a01f7a23cc085f375258"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#adcaf6f9449e6a01f7a23cc085f375258">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService.MelodyService</a></div><div class="ttdeci">MelodyService(IMelodyRepository melodyRepository, IVteService vteService, IVteRepository vteRepository, IMelodyValidationService melodyValidationService, IVteValidationService vteValidationService, IRtuRepository rtuRepository, IRtuQueryService rtuQueryService, IIvrService ivrService, IBaseRepository baseRepository)</div><div class="ttdoc">Конструктор.</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00095">MelodyService.cs:95</a></div></div>
<div class="ttc" id="aclass_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service_html_ae15893d2715ff08dbc3b314555c3a98f"><div class="ttname"><a href="class_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_melody_service.html#ae15893d2715ff08dbc3b314555c3a98f">Cordis.Core.Sip.Class5.Settings.Melodies.Service.MelodyService.RINGBACK</a></div><div class="ttdeci">const string RINGBACK</div><div class="ttdoc">Название мелодии длинные гудки (мелодия дозвона).</div><div class="ttdef"><b>Definition:</b> <a href="_melody_service_8cs_source.html#l00034">MelodyService.cs:34</a></div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_interface_1_1_i_melody_service_html"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_interface_1_1_i_melody_service.html">Cordis.Core.Sip.Class5.Settings.Interface.IMelodyService</a></div><div class="ttdoc">Интерфейс сервиса управления телефонными мелодиями.</div><div class="ttdef"><b>Definition:</b> <a href="_i_melody_service_8cs_source.html#l00011">IMelodyService.cs:12</a></div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_interface_1_1_i_vte_service_html"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_interface_1_1_i_vte_service.html">Cordis.Core.Sip.Class5.Settings.Interface.IVteService</a></div><div class="ttdoc">Сервис методов управления параметрами ВАТС.</div><div class="ttdef"><b>Definition:</b> <a href="_i_vte_service_8cs_source.html#l00011">IVteService.cs:12</a></div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_interface_1_1_i_vte_service_html_a8c0aeb58e65398330d6196c0928b23b9"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_interface_1_1_i_vte_service.html#a8c0aeb58e65398330d6196c0928b23b9">Cordis.Core.Sip.Class5.Settings.Interface.IVteService.GetVtesAsync</a></div><div class="ttdeci">Task&lt; IEnumerable&lt; Vte &gt; &gt; GetVtesAsync(IEnumerable&lt; int &gt; vteIds)</div><div class="ttdoc">Возвращает информация о ресурсе ВАТС.</div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository_html"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html">Cordis.Core.Sip.Class5.Settings.Melodies.Repository.IMelodyRepository</a></div><div class="ttdoc">Интерфейс репозитория для управления телефонными мелодиями.</div><div class="ttdef"><b>Definition:</b> <a href="_i_melody_repository_8cs_source.html#l00011">IMelodyRepository.cs:12</a></div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository_html_a004b7ec1f6453ff20b399a6d69a4fa3e"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html#a004b7ec1f6453ff20b399a6d69a4fa3e">Cordis.Core.Sip.Class5.Settings.Melodies.Repository.IMelodyRepository.GetMelodyByIdAsync</a></div><div class="ttdeci">Task&lt; MelodyInfoWithRtuName &gt; GetMelodyByIdAsync(int melodyId)</div><div class="ttdoc">Получает мелодию по идентификатору.</div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository_html_a00fe07f2f090ddcb4352b7deb6642cd7"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html#a00fe07f2f090ddcb4352b7deb6642cd7">Cordis.Core.Sip.Class5.Settings.Melodies.Repository.IMelodyRepository.GetMelodyBytesByIdAsync</a></div><div class="ttdeci">Task&lt; byte[]&gt; GetMelodyBytesByIdAsync(int melodyId)</div><div class="ttdoc">Получает байты мелодии по идентификатору мелодии.</div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository_html_a1df9e8cc195c51f551a28294a37388d1"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html#a1df9e8cc195c51f551a28294a37388d1">Cordis.Core.Sip.Class5.Settings.Melodies.Repository.IMelodyRepository.DeleteMelodiesAsync</a></div><div class="ttdeci">Task DeleteMelodiesAsync(IEnumerable&lt; int &gt; melodyIds)</div><div class="ttdoc">Удаляет записи из таблицы RTU.prompt с переданными идентификаторами.</div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository_html_a1e81397412684d86d8274acba9795d41"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html#a1e81397412684d86d8274acba9795d41">Cordis.Core.Sip.Class5.Settings.Melodies.Repository.IMelodyRepository.UpdateMelodyDescriptionAsync</a></div><div class="ttdeci">Task UpdateMelodyDescriptionAsync(int vteId, string oldDescription, string newDescription)</div><div class="ttdoc">Устанавливает параметр RTU.prompt.description = newDescription для всех записей с указанным oldDescri...</div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository_html_a7616a9b96785b9ef9036ac1776cba965"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html#a7616a9b96785b9ef9036ac1776cba965">Cordis.Core.Sip.Class5.Settings.Melodies.Repository.IMelodyRepository.AddMelodyCategoryAsync</a></div><div class="ttdeci">Task&lt; int &gt; AddMelodyCategoryAsync(int vteId, int? vtePortId=null)</div><div class="ttdoc">Добавляет запись в таблицу RTU.prompt_category со следующими параметрами: name = &quot;user&quot;,...</div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository_html_a9bd2662af5d6f14bf404b909f82e57ef"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html#a9bd2662af5d6f14bf404b909f82e57ef">Cordis.Core.Sip.Class5.Settings.Melodies.Repository.IMelodyRepository.GetMelodyAndCategoryNameAndRtuDomainIdByMelodyIdAsync</a></div><div class="ttdeci">Task&lt;(string melodyName, string categoryName, string rtuDomainId)&gt; GetMelodyAndCategoryNameAndRtuDomainIdByMelodyIdAsync(int melodyId)</div><div class="ttdoc">Получает название мелодии и ее категории по идентификатору мелодии.</div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository_html_ada345c41a263f0e84908ecf853c67826"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html#ada345c41a263f0e84908ecf853c67826">Cordis.Core.Sip.Class5.Settings.Melodies.Repository.IMelodyRepository.GetMelodyCategoryIdByVteIdAsync</a></div><div class="ttdeci">Task&lt; int?&gt; GetMelodyCategoryIdByVteIdAsync(int vteId)</div><div class="ttdoc">Получает идентификатор категории мелодии по идентификатору ВАТС.</div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository_html_ae1dec0c9a6734938c7a621deb07aae2c"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html#ae1dec0c9a6734938c7a621deb07aae2c">Cordis.Core.Sip.Class5.Settings.Melodies.Repository.IMelodyRepository.GetMelodiesByVteIdAsync</a></div><div class="ttdeci">Task&lt; IEnumerable&lt; MelodyInfoWithRtuName &gt; &gt; GetMelodiesByVteIdAsync(int vteId)</div><div class="ttdoc">Получает мелодии по идентификатору ВАТС.</div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository_html_af1f058b960740f0015b560f1d8ebfaac"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_1_1_i_melody_repository.html#af1f058b960740f0015b560f1d8ebfaac">Cordis.Core.Sip.Class5.Settings.Melodies.Repository.IMelodyRepository.AddMelodyAsync</a></div><div class="ttdeci">Task&lt; int &gt; AddMelodyAsync(string name, string description, int vteId, int melodyCategoryId, byte[] bytes, TimeSpan duration, string fileExtension)</div><div class="ttdoc">Добавляет запись в таблицу RTU.prompt.</div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_i_melody_validation_service_html"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_i_melody_validation_service.html">Cordis.Core.Sip.Class5.Settings.Melodies.Service.IMelodyValidationService</a></div><div class="ttdoc">Интерфейс сервиса проверок при выполнении методов управления телефонными мелодиями.</div><div class="ttdef"><b>Definition:</b> <a href="_i_melody_validation_service_8cs_source.html#l00010">IMelodyValidationService.cs:11</a></div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_i_melody_validation_service_html_a18a378bb4f66f2b9ede87a1673b9f549"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_i_melody_validation_service.html#a18a378bb4f66f2b9ede87a1673b9f549">Cordis.Core.Sip.Class5.Settings.Melodies.Service.IMelodyValidationService.ValidateMelodyIdAsync</a></div><div class="ttdeci">Task ValidateMelodyIdAsync(int melodyId)</div><div class="ttdoc">Проверяет, что мелодия с переданным идентификатором существует.</div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_i_melody_validation_service_html_a72e8482076bea4ab3791087abb69ae91"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_i_melody_validation_service.html#a72e8482076bea4ab3791087abb69ae91">Cordis.Core.Sip.Class5.Settings.Melodies.Service.IMelodyValidationService.ValidateFileExtension</a></div><div class="ttdeci">void ValidateFileExtension(string extension)</div><div class="ttdoc">Проверяет формат аудио-файла MP3 или WAV (проверяем только расширение, так как NAudio не может считат...</div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_i_melody_validation_service_html_aa792db1077db817734742d10f15d50e9"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_i_melody_validation_service.html#aa792db1077db817734742d10f15d50e9">Cordis.Core.Sip.Class5.Settings.Melodies.Service.IMelodyValidationService.ValidateMelodyIdForDeletionAsync</a></div><div class="ttdeci">Task ValidateMelodyIdForDeletionAsync(int melodyId, bool isUsedInIvr)</div><div class="ttdoc">Проверяет, что мелодия с переданным идентификатором, принадлежащий категории с параметром is_default ...</div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_i_melody_validation_service_html_ab83b67df22c93f41f519d4d162d6acda"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_1_1_i_melody_validation_service.html#ab83b67df22c93f41f519d4d162d6acda">Cordis.Core.Sip.Class5.Settings.Melodies.Service.IMelodyValidationService.ValidateFileDescriptionAsync</a></div><div class="ttdeci">Task ValidateFileDescriptionAsync(int vteId, string description, int? melodyId=null)</div><div class="ttdoc">Проверяет, что в переданном названии нет запрещенных символов и не существует мелодии с переданным на...</div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_repository_1_1_i_base_repository_html"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_repository_1_1_i_base_repository.html">Cordis.Core.Sip.Class5.Settings.Repository.IBaseRepository</a></div><div class="ttdoc">Интерфейс репозитория для работы с таблицей в БД.</div><div class="ttdef"><b>Definition:</b> <a href="_i_base_repository_8cs_source.html#l00011">IBaseRepository.cs:12</a></div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_repository_1_1_i_rtu_repository_html"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_repository_1_1_i_rtu_repository.html">Cordis.Core.Sip.Class5.Settings.RtuCommands.Repository.IRtuRepository</a></div><div class="ttdoc">Интерфейс репозитория для работы с запросами РТУ.</div><div class="ttdef"><b>Definition:</b> <a href="_i_rtu_repository_8cs_source.html#l00008">IRtuRepository.cs:9</a></div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_repository_1_1_i_rtu_repository_html_a2d8da79311eeda796770a5319e6f0b85"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_repository_1_1_i_rtu_repository.html#a2d8da79311eeda796770a5319e6f0b85">Cordis.Core.Sip.Class5.Settings.RtuCommands.Repository.IRtuRepository.DownloadFileAsync</a></div><div class="ttdeci">Task&lt; byte[]&gt; DownloadFileAsync(string url)</div><div class="ttdoc">Загружает файл.</div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_service_1_1_i_rtu_query_service_html"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_service_1_1_i_rtu_query_service.html">Cordis.Core.Sip.Class5.Settings.RtuCommands.Service.IRtuQueryService</a></div><div class="ttdoc">Интерфейс сервиса для работы с запросами к РТУ.</div><div class="ttdef"><b>Definition:</b> <a href="_i_rtu_query_service_8cs_source.html#l00011">IRtuQueryService.cs:12</a></div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_service_1_1_i_rtu_query_service_html_adf99f43994567bf5630aa480eb00d8b6"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_service_1_1_i_rtu_query_service.html#adf99f43994567bf5630aa480eb00d8b6">Cordis.Core.Sip.Class5.Settings.RtuCommands.Service.IRtuQueryService.GetPromptsByNameAndCategoryAsync</a></div><div class="ttdeci">Task&lt; IEnumerable&lt; Prompt &gt; &gt; GetPromptsByNameAndCategoryAsync(string rtuDomainId, string name, string category)</div><div class="ttdoc">Получает аудиозаписи по названию и категории.</div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vte_routing_1_1_service_1_1_i_ivr_service_html"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vte_routing_1_1_service_1_1_i_ivr_service.html">Cordis.Core.Sip.Class5.Settings.VteRouting.Service.IIvrService</a></div><div class="ttdoc">Интерфейс сервиса для работы с голосовым меню.</div><div class="ttdef"><b>Definition:</b> <a href="_i_ivr_service_8cs_source.html#l00009">IIvrService.cs:10</a></div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vte_routing_1_1_service_1_1_i_ivr_service_html_a69cca435908745e1fa82d376e9686a53"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vte_routing_1_1_service_1_1_i_ivr_service.html#a69cca435908745e1fa82d376e9686a53">Cordis.Core.Sip.Class5.Settings.VteRouting.Service.IIvrService.DeserializeScriptAsync</a></div><div class="ttdeci">Task&lt; Ivr &gt; DeserializeScriptAsync(string script, int domainId)</div><div class="ttdoc">Формирует Ivr из JSON для хранения голосового меню.</div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_1_1_repository_1_1_i_vte_repository_html"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_1_1_repository_1_1_i_vte_repository.html">Cordis.Core.Sip.Class5.Settings.Vtes.Repository.IVteRepository</a></div><div class="ttdoc">Интерфейс репозитория методов управления параметрами ВАТС.</div><div class="ttdef"><b>Definition:</b> <a href="_i_vte_repository_8cs_source.html#l00010">IVteRepository.cs:11</a></div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_1_1_repository_1_1_i_vte_repository_html_adfce78f9b94b9b266c833f1e843e7830"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_1_1_repository_1_1_i_vte_repository.html#adfce78f9b94b9b266c833f1e843e7830">Cordis.Core.Sip.Class5.Settings.Vtes.Repository.IVteRepository.ConfigureAsync</a></div><div class="ttdeci">Task ConfigureAsync(int domainId)</div><div class="ttdoc">Вызывает хранимую процедуру RTU.ConfigureVte.</div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_1_1_service_1_1_i_vte_validation_service_html"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_1_1_service_1_1_i_vte_validation_service.html">Cordis.Core.Sip.Class5.Settings.Vtes.Service.IVteValidationService</a></div><div class="ttdoc">Интерфейс сервиса проверок при выполнении методов управления параметрами ВАТС.</div><div class="ttdef"><b>Definition:</b> <a href="_i_vte_validation_service_8cs_source.html#l00008">IVteValidationService.cs:9</a></div></div>
<div class="ttc" id="ainterface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_1_1_service_1_1_i_vte_validation_service_html_acc9d729d00509854fb9272a010f7e284"><div class="ttname"><a href="interface_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_1_1_service_1_1_i_vte_validation_service.html#acc9d729d00509854fb9272a010f7e284">Cordis.Core.Sip.Class5.Settings.Vtes.Service.IVteValidationService.ValidateDomainIdAsync</a></div><div class="ttdeci">Task ValidateDomainIdAsync(int domainId)</div><div class="ttdoc">Проверяет корректность идентификатора настроек ВАТС в таблице RTU.domain.</div></div>
<div class="ttc" id="anamespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_extension_html"><div class="ttname"><a href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_extension.html">Cordis.Core.Sip.Class5.Extension</a></div><div class="ttdef"><b>Definition:</b> <a href="_extension_2_call_info_sync_extension_8cs_source.html#l00005">CallInfoSyncExtension.cs:6</a></div></div>
<div class="ttc" id="anamespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model_html"><div class="ttname"><a href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_data_model.html">Cordis.Core.Sip.Class5.Settings.DataModel</a></div><div class="ttdef"><b>Definition:</b> <a href="_abonent_transformation_call_category_8cs_source.html#l00001">AbonentTransformationCallCategory.cs:2</a></div></div>
<div class="ttc" id="anamespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_exceptions_html"><div class="ttname"><a href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_exceptions.html">Cordis.Core.Sip.Class5.Settings.Exceptions</a></div><div class="ttdef"><b>Definition:</b> <a href="_custom_name_already_exists_exception_8cs_source.html#l00003">CustomNameAlreadyExistsException.cs:4</a></div></div>
<div class="ttc" id="anamespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_interface_html"><div class="ttname"><a href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_interface.html">Cordis.Core.Sip.Class5.Settings.Interface</a></div><div class="ttdef"><b>Definition:</b> <a href="_i_call_info_service_8cs_source.html#l00006">ICallInfoService.cs:7</a></div></div>
<div class="ttc" id="anamespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository_html"><div class="ttname"><a href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_repository.html">Cordis.Core.Sip.Class5.Settings.Melodies.Repository</a></div><div class="ttdef"><b>Definition:</b> <a href="_i_melody_repository_8cs_source.html#l00006">IMelodyRepository.cs:7</a></div></div>
<div class="ttc" id="anamespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service_html"><div class="ttname"><a href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_1_1_service.html">Cordis.Core.Sip.Class5.Settings.Melodies.Service</a></div><div class="ttdef"><b>Definition:</b> <a href="_i_melody_validation_service_8cs_source.html#l00005">IMelodyValidationService.cs:6</a></div></div>
<div class="ttc" id="anamespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies_html"><div class="ttname"><a href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_melodies.html">Cordis.Core.Sip.Class5.Settings.Melodies</a></div><div class="ttdef"><b>Definition:</b> <a href="_i_melody_repository_8cs_source.html#l00006">IMelodyRepository.cs:7</a></div></div>
<div class="ttc" id="anamespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_repository_html"><div class="ttname"><a href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_repository.html">Cordis.Core.Sip.Class5.Settings.Repository</a></div><div class="ttdef"><b>Definition:</b> <a href="_base_repository_8cs_source.html#l00011">BaseRepository.cs:12</a></div></div>
<div class="ttc" id="anamespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_repository_html"><div class="ttname"><a href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_repository.html">Cordis.Core.Sip.Class5.Settings.RtuCommands.Repository</a></div><div class="ttdef"><b>Definition:</b> <a href="_i_rtu_repository_8cs_source.html#l00003">IRtuRepository.cs:4</a></div></div>
<div class="ttc" id="anamespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_service_html"><div class="ttname"><a href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_1_1_service.html">Cordis.Core.Sip.Class5.Settings.RtuCommands.Service</a></div><div class="ttdef"><b>Definition:</b> <a href="_i_rtu_command_execute_service_8cs_source.html#l00004">IRtuCommandExecuteService.cs:5</a></div></div>
<div class="ttc" id="anamespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands_html"><div class="ttname"><a href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_rtu_commands.html">Cordis.Core.Sip.Class5.Settings.RtuCommands</a></div><div class="ttdef"><b>Definition:</b> <a href="_i_rtu_repository_8cs_source.html#l00003">IRtuRepository.cs:4</a></div></div>
<div class="ttc" id="anamespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vte_routing_1_1_service_html"><div class="ttname"><a href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vte_routing_1_1_service.html">Cordis.Core.Sip.Class5.Settings.VteRouting.Service</a></div><div class="ttdef"><b>Definition:</b> <a href="_additional_forwarding_service_8cs_source.html#l00011">AdditionalForwardingService.cs:12</a></div></div>
<div class="ttc" id="anamespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vte_routing_html"><div class="ttname"><a href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vte_routing.html">Cordis.Core.Sip.Class5.Settings.VteRouting</a></div><div class="ttdef"><b>Definition:</b> <a href="_call_transfer_8cs_source.html#l00003">CallTransfer.cs:4</a></div></div>
<div class="ttc" id="anamespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_1_1_repository_html"><div class="ttname"><a href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_1_1_repository.html">Cordis.Core.Sip.Class5.Settings.Vtes.Repository</a></div><div class="ttdef"><b>Definition:</b> <a href="_access_groups_reposirory_8cs_source.html#l00010">AccessGroupsReposirory.cs:11</a></div></div>
<div class="ttc" id="anamespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_1_1_service_html"><div class="ttname"><a href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_1_1_service.html">Cordis.Core.Sip.Class5.Settings.Vtes.Service</a></div><div class="ttdef"><b>Definition:</b> <a href="_domain_service_8cs_source.html#l00013">DomainService.cs:14</a></div></div>
<div class="ttc" id="anamespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes_html"><div class="ttname"><a href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_1_1_vtes.html">Cordis.Core.Sip.Class5.Settings.Vtes</a></div><div class="ttdef"><b>Definition:</b> <a href="_access_groups_reposirory_8cs_source.html#l00010">AccessGroupsReposirory.cs:11</a></div></div>
<div class="ttc" id="anamespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings_html"><div class="ttname"><a href="namespace_cordis_1_1_core_1_1_sip_1_1_class5_1_1_settings.html">Cordis.Core.Sip.Class5.Settings</a></div><div class="ttdef"><b>Definition:</b> <a href="_settings_2_call_infos_2_extensions_2_call_info_sync_extension_8cs_source.html#l00009">CallInfoSyncExtension.cs:10</a></div></div>
<div class="ttc" id="anamespace_cordis_1_1_core_1_1_sip_1_1_class5_html"><div class="ttname"><a href="namespace_cordis_1_1_core_1_1_sip_1_1_class5.html">Cordis.Core.Sip.Class5</a></div><div class="ttdef"><b>Definition:</b> <a href="_autowired_attribute_8cs_source.html#l00003">AutowiredAttribute.cs:4</a></div></div>
<div class="ttc" id="anamespace_cordis_1_1_core_1_1_sip_html"><div class="ttname"><a href="namespace_cordis_1_1_core_1_1_sip.html">Cordis.Core.Sip</a></div><div class="ttdef"><b>Definition:</b> <a href="_autowired_attribute_8cs_source.html#l00003">AutowiredAttribute.cs:4</a></div></div>
<div class="ttc" id="anamespace_cordis_1_1_core_html"><div class="ttname"><a href="namespace_cordis_1_1_core.html">Cordis.Core</a></div><div class="ttdef"><b>Definition:</b> <a href="_autowired_attribute_8cs_source.html#l00003">AutowiredAttribute.cs:4</a></div></div>
<div class="ttc" id="anamespace_cordis_html"><div class="ttname"><a href="namespace_cordis.html">Cordis</a></div><div class="ttdef"><b>Definition:</b> <a href="_autowired_attribute_8cs_source.html#l00003">AutowiredAttribute.cs:4</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_8ae0dd75af039a94f4269584fb8eef13.html">Settings</a></li><li class="navelem"><a class="el" href="dir_9fdf79cc07bf983562ef02756c7cb31e.html">Melodies</a></li><li class="navelem"><a class="el" href="dir_03d721bf5e703d5e4f1bbb7d94308496.html">Service</a></li><li class="navelem"><a class="el" href="_melody_service_8cs.html">MelodyService.cs</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
